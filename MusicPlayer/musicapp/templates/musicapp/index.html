{% load static %}

<!DOCTYPE html>
<html>
<head>
    <title>Music Player</title>
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <style>
        body {
            background-image: url('{% static 'images/bg.jpg' %}');
            background-size: cover; /* Adjust this as needed */
        }

        .song-list {
            float: left;
            width: 30%;
            padding: 10px;
        }

        .song {
            padding: 10px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
            cursor: pointer;
        }

        .song:hover {
            background-color: #f5f5f5;
        }

        .song.active {
            background-color: #007bff;
            color: #fff;
        }

        #audio-container {
            position: fixed;
            top: 50px;
            right: 0;
            width: 30%;
            padding: 20px;
            text-align: center;
        }

        #music-player {
            margin-top: 20px;
        }

        #now-playing {
            margin-top: 50px; /* Adjust the margin to move it down */
            text-align: center;
        }

        #controls {
            margin-top: 50px; /* Adjust the margin to move it down by the same length */
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .control-button {
            width: 100px; /* Adjust button size as needed */
            height: 40px;
            margin: 5px;
            border-radius: 20px; /* Add rounded borders */
            background-color: #007bff; /* Set blue color */
            color: #fff; /* Set text color to white */
            transition: background-color 0.3s; /* Add transition for hover effect */
        }

        .control-button:hover {
            background-color: #000; /* Change background color on hover to black */
        }

        .navbar {
            background-color: #000; /* Set black background color for the navbar */
            color: #fff; /* Set text color to white */
            border-radius: 0; /* Remove border-radius to have a flat navbar */
            border-bottom: 2px solid #007bff; /* Add a blue border at the bottom */
            margin-top: px;
        }

        .navbar-brand {
            color: #fff; /* Set text color for the brand to white */
            font-size: 24px; /* Increase the font size for the brand */
        }

        .navbar a {
            color: #fff; /* Set text color for links to white */
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <h1 class="navbar-brand" href="#" style="color: #fff;">Music Player</h1>
    </nav>
    <div class="container">
        <div class="song-list">
            {% for song in songs %}
                <div class="song" onclick="playSong('{{ song.path }}', {{ forloop.counter }})">
                    <p>Song {{ forloop.counter }}: {{ song.title }}</p>
                </div>
            {% endfor %}
        </div>
        <div id="audio-container">
            <h2>Now Playing:</h2>
            <audio id="audio-player" controls></audio>
            <div id="now-playing">
                <div id="controls">
                    <button id="shuffle-button" class="control-button">Shuffle</button>
                    <button id="previous-button" class="control-button">Previous</button>
                    <button id="next-button" class="control-button">Next</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        var audio = document.querySelector('#audio-player');
        var currentSongNumber = 0;

        function playSong(path, songNumber) {
            // Remove the 'active' class from the currently playing song
            var currentlyPlaying = document.querySelector('.song.active');
            if (currentlyPlaying) {
                currentlyPlaying.classList.remove('active');
            }

            audio.src = path;
            audio.play();

            // Set the 'active' class to the clicked song
            var songElement = document.querySelector(`.song:nth-child(${songNumber})`);
            if (songElement) {
                songElement.classList.add('active');
            }

            currentSongNumber = songNumber;
        }

        // Function to play the next song
        function playNextSong() {
            var nextSongNumber = currentSongNumber + 1;
            var nextSongElement = document.querySelector(`.song:nth-child(${nextSongNumber}`);

            if (nextSongElement) {
                var nextSongPath = nextSongElement.getAttribute('onclick').match(/playSong\('(.*?)'/)[1];
                playSong(nextSongPath, nextSongNumber);
            } else {
                // If the next song doesn't exist, play the first song
                var firstSongElement = document.querySelector(`.song:first-child`);
                if (firstSongElement) {
                    var firstSongPath = firstSongElement.getAttribute('onclick').match(/playSong\('(.*?)'/)[1];
                    playSong(firstSongPath, 1);
                }
            }
        }

        document.getElementById('next-button').addEventListener('click', playNextSong);

        // Function to play the previous song
        function playPreviousSong() {
            var previousSongNumber = currentSongNumber - 1;
            if (previousSongNumber > 0) {
                var previousSongElement = document.querySelector(`.song:nth-child(${previousSongNumber})`);
                var previousSongPath = previousSongElement.getAttribute('onclick').match(/playSong\('(.*?)'/)[1];
                playSong(previousSongPath, previousSongNumber);
            } else {
                // If the previous song doesn't exist, play the last song
                var lastSongElement = document.querySelector(`.song:last-child`);
                if (lastSongElement) {
                    var lastSongPath = lastSongElement.getAttribute('onclick').match(/playSong\('(.*?)'/)[1];
                    var maxSongNumber = {{ songs|length }};
                    playSong(lastSongPath, maxSongNumber);
                }
            }
        }

        document.getElementById('previous-button').addEventListener('click', playPreviousSong);

        // Function to play a random song
        function playRandomSong() {
            var maxSongNumber = {{ songs|length }};
            var randomSongNumber = Math.floor(Math.random() * maxSongNumber) + 1;

            var randomSongElement = document.querySelector(`.song:nth-child(${randomSongNumber})`);
            if (randomSongElement) {
                var randomSongPath = randomSongElement.getAttribute('onclick').match(/playSong\('(.*?)'/)[1];
                playSong(randomSongPath, randomSongNumber);
            }
        }

        document.getElementById('shuffle-button').addEventListener('click', playRandomSong);
    </script>
</body>
</html>
